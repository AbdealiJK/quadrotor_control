<?xml version="1.0"?>
<launch>
  <!-- ################################################################### -->
  <!-- Start Gazebo with world running in (max) realtime -->

  <!-- Use this argument to set which world file to open -->
  <arg name="world" value="$(find rl_env)/src/Env/HectorQuad/quad.world"/>
  <!-- Use this argument to decide whether gui should be enabled or not -->
  <arg name="gazebo_gui" value="false" />
  <!-- Extra args to gazebo -->
  <arg name="args" value="" />

  <param name="/use_sim_time" value="true" />

  <!-- Start the headless gazebo -->
  <node name="gazebo" pkg="gazebo_ros" type="gzserver" args="$(arg world) $(arg args)" respawn="false" output="screen"/>

  <!-- Start gazebo gui - if asked for it -->
  <group if="$(arg gazebo_gui)">
    <node name="gazebo_gui" pkg="gazebo_ros" type="gzclient" respawn="false" output="screen"/>
  </group>

  <!-- ################################################################### -->
  <!-- Spawn simulated quadrotor uav -->
  <include file="$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch" >
    <!-- Choose which model to use for the quadrotor -->
    <arg name="model" value="$(find rl_env)/src/Env/HectorQuad/quad.gazebo.xacro"/>
    <!-- Specifies which controller to use
      $(find hector_quadrotor_controller)/launch/controller.launch uses PID
    -->
    <!-- <arg name="controller_definition" value="$(find hector_quadrotor_controller)/launch/controller.launch"/> -->
    <!-- Initial position of the quadrotor -->
    <arg name="x" value="0.0"/>
    <arg name="y" value="0.0"/>
    <arg name="z" value="0.3"/>
    <!-- Motors -->
    <arg name="motors" default="robbe_2827-34_epp1045" />
    <!-- Not sure what these are : were defaultly suggested -->
    <arg name="tf_prefix" value="$(optenv ROS_NAMESPACE)"/>
    <arg name="use_ground_truth_for_tf" value="true" />
    <arg name="use_ground_truth_for_control" value="true" />
  </include>

  <!-- ################################################################### -->
  <!-- Start rviz visualization with preset config -->
  <arg name="rviz_gui" value="true" />
  <group if="$(arg rviz_gui)">
    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find rl_env)/src/Env/HectorQuad/quad.rviz"/>
  </group>

  <!-- ################################################################### -->
  <!-- Debug args for RLAgent and RLEnv -->
  <arg name="debug_rl_arg" default="0" />

  <!-- Start RLAgent and RLEnv -->
  <node name="RLAgent" pkg="rl_agent" type="agent" args="--agent sarsa --prints $(arg debug_rl_arg)" output="screen" />

  <node name="RLEnvironment" pkg="rl_env" type="env" args="--env hectorquad --prints $(arg debug_rl_arg)" output="screen" />
</launch>
